//
// Note that you must have the "compile" command from izpack on your PATH
//
import org.apache.tools.ant.taskdefs.condition.Os

defaultTasks 'clean', 'dist', 'makeInstaller'





task dist(dependsOn: ':checker-lattice-tainting-plugin:jar') << {

}

task makeInstaller(type:Exec)  {


    workingDir 'installer'

  if (Os.isFamily(Os.FAMILY_WINDOWS)) {
    // this needs to be tested
    //throw new GradleException("Building on Windows is not Currently Supported")
    // commandLine 'cmd', 'compile', 'install.xml', '-b', '.', '-o', 'checklt-installer.jar', '-k', 'standard'
  }else{ // All Unix-i

    workingDir 'installer'
    commandLine 'compile', 'install.xml', '-b', '.', '-o', '../dist/checklt-installer.jar', '-k', 'standard'
  }

}




makeInstaller.doFirst {
  println "========================================="
  println " Creating CheckLT Distribution             "
  println "========================================="
}



makeInstaller.doLast {
  println "========================================="
  println " Complete! See installer in dist/checklt-installer.jar "
  println "========================================="
}



// allprojects {
//     task hello << {task -> println "I'm $task.project.name" }
// }
// subprojects {
//     hello << {println "- I depend on water"}
// }

// sourceSets {
//     main {
//         java {
//             srcDir 'src/java'
//         }
//         resources {
//             srcDir 'src/resources'
//         }
//     }
// }